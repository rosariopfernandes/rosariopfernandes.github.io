---
layout: post
title:  "Explorando o ML Kit for Firebase"
date:   2019-02-01 05:00:00 +0200
categories: firebase
---
O artigo original pode ser encontrado no [Medium](https://medium.com/android-dev-moz/mlkit-537775bd7052)
<section data-field="body" class="e-content">
<h4 name="38c3" id="38c3" class="graf graf--h4 graf-after--h3 graf--subtitle">Parte 2 — Linguagem Natural e Identificação de Linguagem</h4><p name="a0cd" id="a0cd" class="graf graf--p graf-after--h4">Este artigo faz parte da série Explorando o ML Kit for Firebase:</p><ol class="postList"><li name="e33c" id="e33c" class="graf graf--li graf-after--p"><a href="/firebase/2018/05/09/Explorando-MLKit-Firebase1.html" data-href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" class="markup--anchor markup--li-anchor" target="_blank">O novo serviço de Machine Learning do Firebase</a></li><li name="c66f" id="c66f" class="graf graf--li graf-after--li graf--trailing">Linguagem Natural e Identificação de Linguagem</li></ol></section><section name="6b60" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="8f9e" id="8f9e" class="graf graf--p graf--leading">No ano passado, a equipa do Firebase anunciou um novo SDK que foi adicionado à plataforma — o <a href="https://firebase.google.com/docs/ml-kit/" data-href="https://firebase.google.com/docs/ml-kit/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">ML Kit</a>. O ML Kit é um SDK que permite que desenvolvedores utilizem Machine Learning em aplicativos Android e iOS. Se você ainda não conhece o ML Kit, leia o <a href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" data-href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" class="markup--anchor markup--p-anchor" target="_blank">primeiro artigo</a> desta série.</p><p name="3df0" id="3df0" class="graf graf--p graf-after--p">Quando foi anunciado, o ML Kit só tinha funcionalidades relacionadas com o ramo <a href="https://pt.wikipedia.org/wiki/Vis%C3%A3o_computacional" data-href="https://pt.wikipedia.org/wiki/Vis%C3%A3o_computacional" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Visão Computacional</a> (Computer Vision). Mas hoje foi adicionada a primeira funcionalidade do ramo <a href="https://pt.wikipedia.org/wiki/Processamento_de_linguagem_natural" data-href="https://pt.wikipedia.org/wiki/Processamento_de_linguagem_natural" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Processamento de Linguagem Natural</a> (Natural Language Processing) — a chamada identificação de linguagem (Language Identification).</p><p name="a56f" id="a56f" class="graf graf--p graf-after--p">Assim, o ML Kit conta agora com 2 pacotes: o <strong class="markup--strong markup--p-strong">ML Vision</strong> (sobre o qual falei no <a href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" data-href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" class="markup--anchor markup--p-anchor" target="_blank">artigo anterior</a>) e o <strong class="markup--strong markup--p-strong">Natural Language</strong> (o tema deste artigo).</p><h3 name="076a" id="076a" class="graf graf--h3 graf-after--p">Natural Language</h3><p name="dd04" id="dd04" class="graf graf--p graf-after--h3">Enquanto que o ML Vision aplica conceitos de Machine Learning em imagens, o pacote Natural Language usa ML no processamento de texto.<br>Atualmente a única funcionalidade inclusa neste pacote é a <a href="https://firebase.google.com/docs/ml-kit/identify-languages" data-href="https://firebase.google.com/docs/ml-kit/identify-languages" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">Identificação de Linguagem</strong></a>, só está disponível para Android ou iOS e só é possível utilizá-la <strong class="markup--strong markup--p-strong">on-device</strong>, pois ainda não tem uma versão <strong class="markup--strong markup--p-strong">cloud</strong>.</p><p name="34d8" id="34d8" class="graf graf--p graf-after--p">Para ter o Natural Language na sua app, você só tem de:</p><ol class="postList"><li name="172a" id="172a" class="graf graf--li graf-after--p"><a href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" data-href="https://medium.com/android-dev-moz/mlkit-540f8e5438c1" class="markup--anchor markup--li-anchor" target="_blank">Adicionar o Firebase ao projecto</a>;</li><li name="f7fb" id="f7fb" class="graf graf--li graf-after--li">Adicionar a dependência do Natural Language no ficheiro build.gradle:</li></ol><pre name="51a6" id="51a6" class="graf graf--pre graf-after--li"><strong class="markup--strong markup--pre-strong">implementation &#39;com.google.firebase:firebase-ml-natural-language:18.1.1&#39;</strong></pre><h4 name="75ca" id="75ca" class="graf graf--h4 graf-after--pre">Identificação de linguagem</h4><p name="a1e2" id="a1e2" class="graf graf--p graf-after--h4">Como o nome sugere, esta funcionalidade analisa um texto e identifica em que linguagem/idioma esse texto está escrito.</p><p name="7419" id="7419" class="graf graf--p graf-after--p">Para utilizar esta funcionalidade, você tem de adicionar a sua dependência no build.gradle:</p><pre name="0fcf" id="0fcf" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">implementation &#39;com.google.firebase:firebase-ml-natural-language-language-id-model:18.0.2&#39;</strong></pre><p name="69a2" id="69a2" class="graf graf--p graf-after--pre">E na sua Activity/Fragment crie um objecto do tipo <code class="markup--code markup--p-code">FirebaseLanguageIdentification</code> :</p><pre name="c2f4" id="c2f4" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">val </strong>identification<strong class="markup--strong markup--pre-strong"> = FirebaseNaturalLanguage.getInstance().languageIdentification</strong></code></pre><p name="58d2" id="58d2" class="graf graf--p graf-after--pre">Esta funcionalidade pode ser usada de 2 maneiras:</p><ol class="postList"><li name="a504" id="a504" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Identificar a linguagem mais provável<br></strong>É como clicar no botão “Estou com sorte” (I’m feeling lucky) do Google Search. Será mostrada a linguagem com maior probabilidade.<br>Basta utilizar o método:</li></ol><pre name="aba7" id="aba7" class="graf graf--pre graf-after--li"><strong class="markup--strong markup--pre-strong">private fun</strong> identificarLinguagemMaisProvavel(texto: <strong class="markup--strong markup--pre-strong">String</strong>) {<br>    identification.identifyLanguage(texto)<br>        .addOnSuccessListener <strong class="markup--strong markup--pre-strong">{ </strong>linguagem <strong class="markup--strong markup--pre-strong">-&gt;<br>            if</strong> (linguagem == &quot;und&quot;) {<br>                // Linguagem desconhecida<br>            } <strong class="markup--strong markup--pre-strong">else</strong> {<br>                // Mostrar a linguagem na UI<br>            }<br>        <strong class="markup--strong markup--pre-strong">}<br>        </strong>.addOnFailureListener <strong class="markup--strong markup--pre-strong">{ </strong>e <strong class="markup--strong markup--pre-strong">-&gt;<br>            </strong>// Ocorreu um erro<br>        <strong class="markup--strong markup--pre-strong">}<br></strong>}</pre><p name="154a" id="154a" class="graf graf--p graf-after--pre">Por padrão, o SDK irá mostrar a linguagem mais provável que tenha confidência maior do que 0,5 . Mas se você quiser especificar o número mínimo de confidência, você pode criar um objecto <code class="markup--code markup--p-code">FirebaseLanguageIdentificationOptions</code> e passar para o identificador:</p><pre name="01a0" id="01a0" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">val</strong> options = FirebaseLanguageIdentificationOptions.Builder()<br>    .setConfidenceThreshold(0.5f)<br>    .build()<br><br><strong class="markup--strong markup--pre-strong">val</strong> identification = FirebaseNaturalLanguage.getInstance()<br>    .getLanguageIdentification(options)</pre><p name="fe49" id="fe49" class="graf graf--p graf-after--pre">2.<strong class="markup--strong markup--p-strong"> Identificar todas linguagens possíveis:<br></strong>Para ver todas as possibilidades, é só utilizar o método:</p><pre name="90aa" id="90aa" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">private fun</strong> identificarLinguagensPossiveis(texto: <strong class="markup--strong markup--pre-strong">String</strong>) {<em class="markup--em markup--pre-em"><br>    </em>identification.identifyPossibleLanguages(texto)<br>        .addOnSuccessListener <strong class="markup--strong markup--pre-strong">{ </strong>linguagens<strong class="markup--strong markup--pre-strong"> -&gt;<br>            var</strong> output = &quot;&quot;<br>            <strong class="markup--strong markup--pre-strong">for (</strong>linguagem <strong class="markup--strong markup--pre-strong">in</strong> linguagens<strong class="markup--strong markup--pre-strong">) {</strong><br>                output += linguagem.<em class="markup--em markup--pre-em">languageCode </em>+ &quot; (${linguagem.<em class="markup--em markup--pre-em">confidence</em>})\n&quot;<br>            <strong class="markup--strong markup--pre-strong">}</strong><br>            // Mostrar o output na UI<br>        <strong class="markup--strong markup--pre-strong">}<br>        </strong>.addOnFailureListener <strong class="markup--strong markup--pre-strong">{ </strong>e <strong class="markup--strong markup--pre-strong">-&gt;<br>            </strong>// Ocorreu um erro<br>        <strong class="markup--strong markup--pre-strong">}<br></strong>}</pre><p name="c11a" id="c11a" class="graf graf--p graf-after--pre">Por padrão, serão mostradas todas linguagens com confidência maior do que 0,01. Mas se você quiser especificar o número mínimo de confidência, crie um objeto <code class="markup--code markup--p-code">FirebaseLanguageIdentificationOptions</code> como mostrado no método 1 (linguagem mais provável).</p><p name="8686" id="8686" class="graf graf--p graf-after--p">Note que a String retornada pelo SDK é o <a href="https://en.wikipedia.org/wiki/IETF_language_tag" data-href="https://en.wikipedia.org/wiki/IETF_language_tag" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">código BCP-47 da linguagem</a>. Você pode encontrar a lista de todas as linguagens suportadas <a href="https://firebase.google.com/docs/ml-kit/langid-support" data-href="https://firebase.google.com/docs/ml-kit/langid-support" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">aqui</a>.</p><p name="0975" id="0975" class="graf graf--p graf-after--p">Veja o código completo da Activity aqui:</p><figure name="841d" id="841d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/rosariopfernandes/3f141391a21c5b88d3d0a935221c2d56.js"></script></figure><p name="a3e2" id="a3e2" class="graf graf--p graf-after--figure">Identificar linguagens no Android com o Firebase é tão simples quanto isso. Esta funcionalidade pode não parecer útil, mas é sim em alguns casos de uso. Por exemplo: se você tiver criado uma aplicação que é uma espécie de um blog, você pode usar a identificação de linguagens para analisar os blog posts que cada utilizador lê. Se você souber que um certo utilizador lê muitos posts em chinês, talvez seja uma boa ideia recomendar-lhe mais posts em chinês.</p><p name="3cd6" id="3cd6" class="graf graf--p graf-after--p">Pude notar que diferentemente do pacote ML Vision, o SDK do Natural Language não ocupa tanto espaço assim. Quando testei o ML Vision pela primeira vez, o APK gerado tinha aproximadamente 15Mb. Enquanto usando o Natural Language, o APK tem aproximadamente 5Mb. Acho que é uma diferença compreensível, pois o SDK do ML Vision certamente usa modelos mais complexos e provavelmente leva consigo algumas imagens usadas para o treinamento destes modelos.</p><p name="7967" id="7967" class="graf graf--p graf-after--p graf--trailing">Vale lembrar que esta é só a primeira funcionalidade que o Firebase traz para o pacote Natural Language. É provável que ao longo do tempo sejam adicionadas mais funcionalidades para este pacote, afinal de contas vem aí o <a href="https://cloud.withgoogle.com/next18/" data-href="https://cloud.withgoogle.com/next18/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Cloud Next 19</a> e o <a href="https://events.google.com/io/" data-href="https://events.google.com/io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Google I/O 2019</a> — dois eventos anuais onde a Google tradicionalmente anuncia novas funcionalidades do Firebase. Irei atualizar este artigo sempre que houverem novidades neste pacote, então continue me seguindo para não perdê-las.</p></div></div></section><section name="909e" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="daec" id="daec" class="graf graf--p graf--leading graf--trailing">Caso tenha alguma dúvida ou sugestão, deixe abaixo nos comentários. Se você estiver tentando usar o ML Kit e teve um problema, <a href="https://pt.stackoverflow.com/questions/ask?tags=firebase" data-href="https://pt.stackoverflow.com/questions/ask?tags=firebase" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">coloque ele no StackOverflow</a>, explicando o que você fez e qual foi o erro que teve. De certeza que você obterá ajuda de mim ou de alguém da comunidade. 🙂</p></div></div>
</section>
